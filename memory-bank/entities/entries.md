# Entity: Entries

**Overview:**
Entries represent final, posted financial movements within the Smart Ledger system. They are the core records that affect account balances and reflect confirmed transactions. Unlike Staging Entries, Entries are not typically created directly via an API but are the result of processing other data (e.g., Staging Entries, system-generated events).

**Prisma Schema Definition (`Entry` model from `prisma/schema.prisma`):**
```prisma
enum EntryStatus {
  EXPECTED  // Anticipated movement, possibly generated by a rule or system logic.
  POSTED    // Confirmed, final entry impacting the ledger's posted_balance.
  ARCHIVED  // Superseded, corrected, or otherwise no longer active; discarded_at should be set.
}

model Entry {
  entry_id         String      @id @default(cuid())
  account_id       String
  transaction_id   String?     // Foreign Key to a future Transaction model
  entry_type       EntryType   // Reuses existing DEBIT/CREDIT enum
  amount           Decimal
  currency         String
  status           EntryStatus
  effective_date   DateTime
  metadata         Json?       @db.JsonB
  discarded_at     DateTime?   // Set when status is ARCHIVED
  created_at       DateTime    @default(now())
  updated_at       DateTime    @updatedAt

  account          Account     @relation(fields: [account_id], references: [account_id])
  // transaction   Transaction? @relation(fields: [transaction_id], references: [transaction_id]) // Future: Link to Transaction model
}
```

**API Endpoints:**
- `GET /api/accounts/:account_id/entries`: List entries for the specified account. Supports filtering by `status` (e.g., `EXPECTED`, `POSTED`, `ARCHIVED`) via query parameters.
  - **Note:** There is no `POST` endpoint for creating entries directly via the API. Entries are created through internal system processes.

**Core Logic (`src/server/core/entry/index.js`):**
- `listEntries(account_id, queryParams)`: Retrieves entries for a given account, allowing filtering by status. Includes related account details.

**Lifecycle & Purpose:**
- `EXPECTED`: An entry that is anticipated but not yet confirmed. This might be generated by the recon engine based on rules.
- `POSTED`: A confirmed financial movement that has impacted an account's balance. This is the primary active state for ledger entries.
- `ARCHIVED`: An entry that is no longer active, typically because it has been corrected, superseded, or is part of a voided transaction. The `discarded_at` field should be populated for these entries.

**Future Considerations:**
- The `Transaction` model will group related entries.
- Logic for calculating account balances will primarily use `POSTED` entries.
- Internal processes will be responsible for creating `Entry` records, potentially transitioning `StagingEntry` records to `Entry` records or generating `EXPECTED` entries based on system rules.
